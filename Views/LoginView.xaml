<Window x:Class="docment_tools_client.Views.LoginView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:mui="http://schemas.modernwpf.com/2019"
        xmlns:helpers="clr-namespace:docment_tools_client.Helpers"
        xmlns:local="clr-namespace:docment_tools_client.Views"
        mc:Ignorable="d"
        xmlns:vm="clr-namespace:docment_tools_client.ViewModels"
        Title="律表通 - 登录" Height="520" Width="350"
        ResizeMode="NoResize" WindowStartupLocation="CenterScreen"
        Background="White"
        Icon="pack://application:,,,/Resources/Images/icon.png">

    <!-- 窗口资源（绑定ViewModel） -->
    <Window.Resources>
        <vm:LoginViewModel x:Key="LoginViewModel"/>
    </Window.Resources>

    <!-- 主布局Grid -->
    <Grid DataContext="{StaticResource LoginViewModel}" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Logo -->
        <Image Grid.Row="0" Source="/Resources/Images/logo.png" 
               Width="150" Height="100" Margin="0,20,0,10"
               HorizontalAlignment="Center"/>

        <!-- 标题描述 -->
        <TextBlock Grid.Row="1" Text="律表通" 
                   HorizontalAlignment="Center" FontSize="18" 
                   FontWeight="Bold" Margin="0,0,0,20"/>
        <TextBlock Grid.Row="2" Text="高效批量生成各类法律文书，支持离线操作" 
                   HorizontalAlignment="Center" FontSize="12" 
                   Foreground="Gray"
                   Margin="0,0,0,30"/>

        <!-- 账号输入框 -->
        <TextBox Grid.Row="3" mui:ControlHelper.PlaceholderText="请输入账号"
                     Text="{Binding Account, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,0,10" Width="250" HorizontalAlignment="Center"/>

        <!-- 密码输入框 -->
        <PasswordBox Grid.Row="4" mui:ControlHelper.PlaceholderText="请输入密码"
                     helpers:PasswordBoxHelper.Attach="True"
                     helpers:PasswordBoxHelper.Password="{Binding Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,0,20" Width="250" HorizontalAlignment="Center"/>

        <!-- 登录按钮 -->
        <Button Grid.Row="5" 
                    Command="{Binding LoginCommand}" 
                    IsEnabled="{Binding IsLoginButtonEnabled}"
                    Width="250" Height="35"
                    HorizontalAlignment="Center" Margin="0,0,0,10"
                    Background="#0078D7" Foreground="White" Click="Button_Click">
            <Button.Content>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding LoadingTip, FallbackValue='登录'}" />
                    <mui:ProgressRing Visibility="{Binding IsLoginButtonEnabled, Converter={helpers:BoolToVisibilityConverter IsInverted=True}}" 
                                      Width="16" Height="16" Margin="5,0,0,0" IsActive="True"/>
                </StackPanel>
            </Button.Content>
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                             <Setter Property="Background" Value="#005A9E"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                             <Setter Property="Background" Value="#CCCCCC"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>

        <!-- 协议勾选 (Row 6) -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,10">
            <CheckBox IsChecked="{Binding IsAgreementChecked}" VerticalAlignment="Center" Margin="0" MinWidth="0"/>
            <TextBlock Margin="2,0,0,0" VerticalAlignment="Center" FontSize="12">
                <Run Text="我已阅读并同意 "/>
                <Hyperlink Command="{Binding OpenAgreementCommand}" Foreground="#0078D7" TextDecorations="None">
                    <Run Text="《平台服务协议》"/>
                </Hyperlink>
            </TextBlock>
        </StackPanel>

        <!-- 申请账号按钮 (Row 8 to be safe with the new definitions) -->
        <Button Grid.Row="8" Content="申请账号" 
                    Command="{Binding ApplyAccountCommand}"
                    Background="Transparent" Foreground="#0078D7" BorderThickness="0"
                    HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,10"/>
    </Grid>
</Window>